<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Love Surprise üíñ</title>

<style>
body{
  font-family:sans-serif;
  background:linear-gradient(135deg,#ffc0cb,#ff8fcf);
  margin:0;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
}
.container{
  background:white;
  width:95%;
  max-width:420px;
  padding:20px;
  border-radius:20px;
  box-shadow:0 10px 30px rgba(0,0,0,0.2);
}
.hidden{display:none;}
input,textarea{
  width:100%;
  padding:10px;
  margin:8px 0;
  border-radius:10px;
  border:1px solid #ffb6d9;
}
button{
  padding:10px 15px;
  margin:8px 5px;
  border:none;
  border-radius:10px;
  background:#ff69b4;
  color:white;
  cursor:pointer;
  width:100%;
}
iframe{
  width:100%;
  height:200px;
  border-radius:12px;
}
.step{
  font-weight:bold;
  margin-bottom:10px;
  color:#ff1493;
}
</style>
</head>
<body>

<div class="container" id="app"></div>

<script>
const params=new URLSearchParams(window.location.search);
const memoryData=params.get("data");

if(memoryData){
  loadView(JSON.parse(atob(memoryData)));
}else{
  loadCreate();
}

function loadCreate(){
document.getElementById("app").innerHTML=`

<h2>üíñ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥ üíñ</h2>

<div id="step1">
<div class="step">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1/3</div>
<input type="text" id="title" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á">
<textarea id="story" placeholder="‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß"></textarea>
<input type="text" id="youtube" placeholder="‡∏•‡∏¥‡∏á‡∏Å‡πå YouTube (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)">
<button onclick="nextStep(2)">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚ûú</button>
</div>

<div id="step2" class="hidden">
<div class="step">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2/3</div>
<label>
<input type="checkbox" id="usePassword"> ‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™ 6 ‡∏´‡∏•‡∏±‡∏Å
</label>
<input type="number" id="password" placeholder="‡∏£‡∏´‡∏±‡∏™ 6 ‡∏´‡∏•‡∏±‡∏Å" style="display:none;">
<button onclick="nextStep(3)">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚ûú</button>
<button onclick="nextStep(1)">‚¨Ö ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
</div>

<div id="step3" class="hidden">
<div class="step">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3/3</div>

<h3>üí≥ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô 59 ‡∏ö‡∏≤‡∏ó</h3>
<img src="qr.png" style="width:100%;border-radius:15px;">

<p><b>‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ:</b> ‡∏ì‡∏±‡∏ê‡∏ß‡∏±‡∏ï‡∏£ ‡∏ä‡∏π‡∏õ‡∏£‡∏≤‡∏£‡∏°‡∏¢‡πå</p>

<br>
<button onclick="createLink()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå</button>

<p id="result"></p>
</div>
`;

document.getElementById("usePassword").addEventListener("change",function(){
  document.getElementById("password").style.display=this.checked?"block":"none";
});
}

function nextStep(step){
document.querySelectorAll("#step1,#step2,#step3")
.forEach(el=>el.classList.add("hidden"));
document.getElementById("step"+step).classList.remove("hidden");
}

function createLink(){
const title=document.getElementById("title").value;
const story=document.getElementById("story").value;
const youtube=document.getElementById("youtube").value;
const usePass=document.getElementById("usePassword").checked;
const password=document.getElementById("password").value;

if(!title || !story){
  alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö");
  return;
}

if(usePass && !/^[0-9]{6}$/.test(password)){
  alert("‡∏£‡∏´‡∏±‡∏™‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 6 ‡∏´‡∏•‡∏±‡∏Å");
  return;
}

const data={
  title,
  story,
  youtube,
  password:usePass?password:null
};

const link=window.location.href.split("?")[0]
+"?data="+btoa(JSON.stringify(data));

document.getElementById("result").innerHTML=
"‚úÖ ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì:<br><input value='"+link+"' readonly onclick='this.select()'>";
}

function loadView(data){

if(data.password){
document.getElementById("app").innerHTML=`
<h3>üîê ‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™ 6 ‡∏´‡∏•‡∏±‡∏Å</h3>
<input type="number" id="pass">
<button onclick="checkPass('${data.password}','${btoa(JSON.stringify(data))}')">‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏π</button>
<p id="wrong" style="color:red;"></p>
`;
}else{
showMemory(data);
}
}

function checkPass(real,encoded){
const input=document.getElementById("pass").value;
if(input===real){
  showMemory(JSON.parse(atob(encoded)));
}else{
  document.getElementById("wrong").innerText="‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
}
}

function getVideoId(url){
return url?.split("v=")[1]?.split("&")[0];
}

function showMemory(data){
document.getElementById("app").innerHTML=`
<h2>${data.title}</h2>
<p>${data.story}</p>
${data.youtube?`
<iframe src="https://www.youtube.com/embed/${getVideoId(data.youtube)}"
frameborder="0" allowfullscreen></iframe>`:""}
<p style="color:#ff1493;">üíñ ‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏π‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</p>
`;
}
</script>

</body>
</html>
